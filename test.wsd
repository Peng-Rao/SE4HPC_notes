@startuml
actor "News Channel" as NewsChannel
participant "Traffic Manager System" as TrafficManager
participant "Event Collector" as EventCollector
participant "Message Bus" as MessageBus
participant "Public Transport Service" as PublicTransport
participant "Traffic Analysis" as TrafficAnalysis
actor "Urban Manager" as UrbanManager
participant "City Infrastructure" as CityInfra
participant "Logger" as Logger
actor "Citizens" as Citizens

NewsChannel -> TrafficManager: Event Announcement (e.g., concert)
activate TrafficManager

TrafficManager -> EventCollector: Trigger Event Handling
activate EventCollector

EventCollector -> MessageBus: Request Traffic Sensor Data
activate MessageBus
MessageBus --> EventCollector: Raw Traffic Data
deactivate MessageBus

EventCollector -> PublicTransport: getScheduleByStreet(street)
activate PublicTransport
PublicTransport --> EventCollector: Schedule Data
deactivate PublicTransport

EventCollector -> EventCollector: **Process & Aggregate Data**
activate EventCollector

EventCollector -> TrafficAnalysis: Analyze Impact (event + data)
activate TrafficAnalysis
TrafficAnalysis --> EventCollector: Suggested Configurations
deactivate TrafficAnalysis

EventCollector -> TrafficManager: Submit Proposal (config)
deactivate EventCollector
TrafficManager -> UrbanManager: Review Proposal
activate UrbanManager
UrbanManager --> TrafficManager: Approval/Rejection
deactivate UrbanManager

alt Approved
  TrafficManager -> CityInfra: Apply Configurations\n(Traffic Lights, Roads, Transport)
  activate CityInfra
  CityInfra --> TrafficManager: Success
  deactivate CityInfra

  TrafficManager -> Logger: Log Event & Config
  activate Logger
  Logger --> TrafficManager: Log Confirmation
  deactivate Logger

  TrafficManager -> Citizens: Publish Daily Report
end

deactivate TrafficManager
@enduml